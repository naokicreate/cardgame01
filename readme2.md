前提となる仕様
基本的なゲーム構造や用語は、既存の「ウェブアプリカードゲーム：構造とルール」ドキュメント（ID: card_game_rules_jp）を参照してください。

本依頼書に記載されているルールや仕様が、「ウェブアプリカードゲーム：構造とルール」と異なる場合は、本依頼書の記述を優先してください。

UIは、ゲームのロジックが動作し、状況が把握できる最低限のもので構いません。デザインの作り込みは不要です。

3. 実装範囲
ゲームの初期セットアップ（デッキシャッフル、初期手札配布、初期リソース配布）

ターン進行管理（スタートフェイズ、ドローフェイズ、メインフェイズ、攻撃フェイズ、エンドフェイズ）

プレイヤーのアクション処理

カードをドローする

手札からカードをプレイする（コスト支払い、場への配置）

ユニットカードで相手ユニットまたは相手プレイヤーへ攻撃する

カードの能力を発動する（今回は簡略化し、場に出た時の自動効果や、キーワード能力のみを想定）

ターンを終了する

戦闘処理

攻撃対象の選択

ブロック処理

ダメージ計算

ユニットの破壊処理

リソース（コア）管理

ライフポイント管理

勝利条件判定（相手ライフポイントが0）

特殊ルールの処理（デッキ切れ）

基本的なゲーム画面の表示（両プレイヤーの手札、フィールド、ライフポイント、コアなど）

4. ゲームルールの詳細・明確化
4.1. カードの種類と基本情報
各カードは、以下の情報を持つものとします。

id: カード固有の識別子 (例: "unit001", "trap001")

name: カード名 (例: "ゴブリン", "落とし穴")

type: "unit", "trap", "resource"

cost: プレイに必要なコア数 (例: 3)

attack: 攻撃力 (ユニットカードのみ。例: 2)

health: 体力 (ユニットカードのみ。例: 3)

effects: 効果 (オブジェクト配列。例: [{type: "onPlay", action: "draw", value: 1}, {type: "keyword", name: "速攻"}])

type: "onPlay" (場に出た時), "onAttack" (攻撃時), "onDestroyed" (破壊時), "keyword" (キーワード能力), "continuous" (永続効果、リソースカード用)

action: 効果の内容 (例: "draw", "damageUnit", "damagePlayer", "healPlayer", "destroyUnit", "buffAttack", "addCore")

value: 効果の数値 (例: 1, 300)

target: 効果の対象 (例: "self", "opponentUnit", "opponentPlayer", "allPlayerUnits")

name: キーワード能力名 (例: "速攻", "飛行", "挑発", "毒")

description: カード効果のテキスト説明 (例: "場に出た時、カードを1枚引く。")

illust_url: カード画像のURL（今回はサンプル画像でOK。例: "https://placehold.co/100x140?text=Card"）

ユニットカード (Unit Card):

フィールドに配置され、攻撃や防御を行います。

attack と health を持ちます。health が0以下になると破壊され、捨て札置き場に送られます。

トラップカード (Trap Card):

手札からフィールドに裏向きでセットできます（コスト支払い）。

特定の条件を満たした時に自動で発動し、効果を解決した後、捨て札置き場に送られます。

例：「相手ユニットが攻撃宣言した時、その攻撃ユニットを破壊する」

発動タイミングは相手ターン中でも可能です。

セットできるトラップカードはフィールドに1枚までとします。

リソースカード (Resource Card):

手札からプレイすると、フィールドに配置され、永続的な効果やフェイズ開始時に発動する効果をもたらします。

例1：「自分のスタートフェイズ開始時、自分の全てのユニットの攻撃力を+1する」

例2：「自分のドローフェイズ時、追加でカードを1枚引く」

フィールドに配置できるリソースカードは1枚までとします。

4.2. デッキと手札
デッキ枚数: 各プレイヤー20枚固定。

同名カード制限: 1デッキに3枚まで。

初期手札: 3枚。

手札上限: 7枚。エンドフェイズに超えている場合、超過分をプレイヤーが選択して捨て札にする。

4.3. リソース（コア）
初期コア: 各プレイヤー5コア。

ターン開始時獲得コア: 毎自ターンのスタートフェイズに3コア獲得。

最大コア: 10コア。これを超えて獲得はできない。

持ち越し: 使わなかったコアは次のターンに持ち越せる。

4.4. ライフポイント (LP)
初期LP: 各プレイヤー 10000 LP。

勝利条件: 相手プレイヤーのLPを0にする。

4.5. フィールド
ユニットゾーン: 各プレイヤー、最大5体までユニットを配置可能。

トラップゾーン: 各プレイヤー、1枚までトラップカードをセット可能。

リソースゾーン: 各プレイヤー、1枚までリソースカードを配置可能。

4.6. ターン進行
スタートフェイズ (Start Phase):

ターン開始時に誘発する効果を処理（例: リソースカードの効果）。

プレイヤーは3コアを得る（最大10コアまで）。

ドローフェイズ (Draw Phase):

デッキからカードを1枚引く。

デッキ切れの場合、プレイヤーは1000 LPのダメージを受ける。引けなかった場合、その後のフェイズは進行する。

ドローフェイズに誘発する効果を処理（例: リソースカードの効果）。

メインフェイズ (Main Phase):

以下の行動をコストが許す限り、任意の順序・回数実行可能。

手札からユニットカードを召喚（ユニットゾーンに空きがある場合）。

手札からトラップカードをセット（トラップゾーンに空きがある場合）。

手札からリソースカードをプレイ（リソースゾーンに空きがある場合）。

場に出ているユニットの起動効果を使用（今回は実装簡略化のため、起動効果はなしとする）。

攻撃フェイズへ移行する（移行しないことも可能）。

攻撃フェイズ (Attack Phase / Battle Phase):

メインフェイズから移行。

自分の場の「攻撃可能な状態のユニット」（召喚酔いしていない、または「速攻」持ち）を1体選択。

攻撃対象を選択（相手ユニット1体、または相手プレイヤー）。

相手の場に「挑発」を持つユニットがいる場合、そのユニットを先に攻撃対象としなければならない。複数いる場合は、攻撃側が1体選択。

ブロック宣言: 攻撃対象がユニットの場合、またはプレイヤーへの攻撃に対して、防御側は自分の場の「ブロック可能なユニット」1体を選んでブロックできる。

「飛行」ユニットへの攻撃は、「飛行」ユニットでしかブロックできない。

ダメージ計算:

ユニット vs ユニット（ブロック発生時）:

攻撃ユニットは防御ユニットに自身の攻撃力分のダメージを与える。

防御ユニットは攻撃ユニットに自身の攻撃力分のダメージを与える（相打ちあり）。

ユニットの体力が0以下になったら破壊される。

ユニット vs ユニット（ブロックなし、挑発なしで相手ユニットを直接攻撃）:

攻撃ユニットは対象ユニットに自身の攻撃力分のダメージを与える。

対象ユニットの体力が0以下になったら破壊される。

ユニット vs プレイヤー（ブロックなし、またはブロック貫通なし）:

攻撃ユニットは相手プレイヤーに自身の攻撃力分のダメージを与える。相手プレイヤーのLPを減らす。

上記を攻撃可能なユニットの数だけ繰り返せる（1ユニット1ターン1回攻撃）。

エンドフェイズ (End Phase):

ターン終了時に誘発する効果を処理。

手札が上限（7枚）を超えている場合、プレイヤーは手札を選択して捨て札にする。

相手プレイヤーにターンを渡す。

4.7. キーワード能力
速攻 (Charge): 場に出たターンにすぐ攻撃できる。（通常、ユニットは場に出た次のターンから攻撃可能＝召喚酔い）

飛行 (Flying): 「飛行」を持たないユニットからはブロックされない。「飛行」を持つユニット同士はブロック可能。

挑発 (Taunt): このユニットが場にいる限り、相手プレイヤーは他のユニット（挑発持ち以外）やプレイヤー本体を攻撃対象に選べない。このユニットを先に攻撃しなければならない。

毒 (Poison): このユニットが戦闘で他のユニットにダメージを与えた場合、そのユニットを戦闘終了時に破壊する（ダメージ量に関わらず）。

4.8. カード効果の解決順序
原則として、ターンプレイヤーがアクションを起こした際に発動する効果が先に解決されます。

同一タイミングで複数の効果が発動する場合（例：あるカードが破壊された時に誘発する効果が複数ある場合）、ターンプレイヤー側の効果から先に解決し、その後非ターンプレイヤーの効果を解決します。両者が同時に発動する場合は、事前に定めた優先順位（例：ユニットカードの効果＞トラップカードの効果＞リソースカードの効果）や、場に出た順番（古い順）などで解決します。

トラップカードの割り込み: 相手の行動に対してトラップカードが発動する場合、相手の行動の解決前にトラップカードの効果を解決します。（例：ユニットAが攻撃宣言 → トラップ発動条件合致 → トラップ効果解決 → （ユニットAが破壊されていなければ）ユニットAの攻撃処理）

4.9. 特殊なルール
デッキ切れ: ドローフェイズにデッキからカードを引けない場合、プレイヤーは1000 LPのダメージを受ける。その後もゲームは続行する。

引き分け: 同時に両プレイヤーのLPが0以下になった場合は引き分けとする。（今回は実装を簡略化するため、同時敗北＝引き分けは考慮せず、先にLPが0になった方の負けとする）